{% extends "base.html" %}

{% block page_subtitle %}
<p>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π</p>
{% endblock %}

{% block content %}
<div class="edit-form">
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="form-section" onclick="selectElement(this)">
        <div class="section-title">
            <i class="fas fa-info-circle"></i>
            –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        </div>
        
        <div class="form-group">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏</label>
            <input type="text" class="form-input" value="{{ role_model.name }}" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" id="roleModelName">
        </div>
        
        <div class="form-group">
            <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea class="form-input form-textarea" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏" id="roleModelDescription">{{ role_model.description or "" }}</textarea>
        </div>

        <!-- –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–∏ -->
        <div class="ai-tools-trigger" onclick="toggleAITools('model')" onmouseenter="openAIToolsOnHover('model')">
            <i class="fas fa-magic"></i>
        </div>
        <div class="ai-tools-menu" id="model-tools">
            <div class="ai-tools-menu-item" onclick="aiOptimizeModel()">
                <i class="fas fa-magic"></i>
                –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
            </div>
            <div class="ai-tools-menu-item" onclick="aiAnalyzeGaps()">
                <i class="fas fa-search"></i>
                –ù–∞–π—Ç–∏ –ø—Ä–æ–±–µ–ª—ã
            </div>
            <div class="ai-tools-menu-item" onclick="aiSuggestProfiles()">
                <i class="fas fa-lightbulb"></i>
                –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å
            </div>
            <div class="ai-tools-menu-item" onclick="aiCompareModels()">
                <i class="fas fa-balance-scale"></i>
                –°—Ä–∞–≤–Ω–∏—Ç—å
            </div>
            <div class="ai-tools-menu-item" onclick="aiValidateCriteria()">
                <i class="fas fa-check-circle"></i>
                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
            </div>
            <div class="ai-tools-menu-item" onclick="aiGenerateReport()">
                <i class="fas fa-chart-bar"></i>
                –û—Ç—á–µ—Ç
            </div>
        </div>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª–∏ —Ä–æ–ª–µ–π -->
    <div class="form-section" onclick="selectElement(this)">
        <div class="section-title">
            <i class="fas fa-users"></i>
            –ü—Ä–æ—Ñ–∏–ª–∏ —Ä–æ–ª–µ–π
        </div>
        
        <div class="profiles-list">
            {% for profile in profiles %}
            <div class="profile-item" data-profile="{{ profile.id }}" onclick="selectElement(this)">
                <div class="profile-info">
                    <div class="profile-name">{{ profile.name }}</div>
                    <div class="profile-criteria">
                        {% if profile.criteria %}
                            {% set criteria_parts = [] %}
                            {% if profile.criteria.get('employee_profiles') %}
                                {% set _ = criteria_parts.append(profile.criteria.employee_profiles|join(', ')) %}
                            {% endif %}
                            {% if profile.criteria.get('positions') %}
                                {% set _ = criteria_parts.append(profile.criteria.positions|join(', ')) %}
                            {% endif %}
                            {% if profile.criteria.get('org_units_type') %}
                                {% set _ = criteria_parts.append(profile.criteria.org_units_type|join(', ')) %}
                            {% endif %}
                            {{ criteria_parts|join(' ‚Ä¢ ') }}
                        {% else %}
                            –ö—Ä–∏—Ç–µ—Ä–∏–∏ –Ω–µ –∑–∞–¥–∞–Ω—ã
                        {% endif %}
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); editProfile({{ profile.id }})">
                        <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); duplicateProfile({{ profile.id }})">
                        <i class="fas fa-copy"></i> –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); deleteProfile({{ profile.id }})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <!-- –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è -->
                <div class="ai-tools-trigger" onclick="toggleAITools('profile-{{ profile.id }}')" onmouseenter="openAIToolsOnHover('profile-{{ profile.id }}')">
                    <i class="fas fa-magic"></i>
                </div>
                <div class="ai-tools-menu" id="profile-{{ profile.id }}-tools">
                    <div class="ai-tools-menu-item" onclick="aiOptimizeCriteria({{ profile.id }})">
                        <i class="fas fa-tune"></i>
                        –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                    </div>
                    <div class="ai-tools-menu-item" onclick="aiSuggestAccesses({{ profile.id }})">
                        <i class="fas fa-key"></i>
                        –î–æ—Å—Ç—É–ø—ã
                    </div>
                    <div class="ai-tools-menu-item" onclick="aiSplitProfile({{ profile.id }})">
                        <i class="fas fa-expand-arrows-alt"></i>
                        –†–∞–∑–¥–µ–ª–∏—Ç—å
                    </div>
                    <div class="ai-tools-menu-item" onclick="aiAutoComplete({{ profile.id }})">
                        <i class="fas fa-magic"></i>
                        –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <button class="btn btn-primary" onclick="addNewProfile()" style="margin-top: 15px;">
            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
        </button>
    </div>
</div>

<div class="form-actions">
    <button class="btn btn-secondary" onclick="window.location.href='/role-models/{{ role_model.id }}'">
        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
    </button>
    <button class="btn btn-primary" onclick="saveModel()">
        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
    </button>
</div>
{% endblock %}

{% block chat_context %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: {{ role_model.name }}{% endblock %}

{% block chat_placeholder %}–ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏...{% endblock %}

{% block extra_js %}
<script>
    let currentContext = null;

    function selectElement(element) {
        // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        document.querySelectorAll('.selected').forEach(el => {
            el.classList.remove('selected');
        });
        
        // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
        element.classList.add('selected');
    }

    function toggleAITools(toolId) {
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–µ–Ω—é
        document.querySelectorAll('.ai-tools-menu.active').forEach(menu => {
            menu.classList.remove('active');
        });
        
        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω–æ–µ –º–µ–Ω—é
        const menu = document.getElementById(toolId + '-tools');
        if (menu) {
            menu.classList.add('active');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –ª–∏ –º–µ–Ω—é –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã —ç–∫—Ä–∞–Ω–∞
            const rect = menu.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            
            // –ï—Å–ª–∏ –º–µ–Ω—é –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É, –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –µ–≥–æ
            if (rect.bottom > viewportHeight - 20) {
                menu.classList.add('overlap');
            } else {
                menu.classList.remove('overlap');
            }
        }
    }

    function openAIToolsOnHover(toolId) {
        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        const menu = document.getElementById(toolId + '-tools');
        if (menu && !menu.classList.contains('active')) {
            menu.classList.add('active');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            const rect = menu.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            
            if (rect.bottom > viewportHeight - 20) {
                menu.classList.add('overlap');
            } else {
                menu.classList.remove('overlap');
            }
        }
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã
    document.addEventListener('click', function(e) {
        // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –∏–ª–∏ input - –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
        if (e.target.closest('button') || e.target.closest('input') || e.target.closest('textarea')) {
            return;
        }
        
        // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
        if (e.target.closest('.ai-tools-trigger')) {
            return; // –ù–µ —Å–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é
        }
        
        // –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç —Å –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
        if (e.target.closest('.form-section') || e.target.closest('.profile-item')) {
            const element = e.target.closest('.form-section') || e.target.closest('.profile-item');
            selectElement(element);
            return;
        }
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
    document.addEventListener('focusout', function(e) {
        setTimeout(() => {
            if (!document.activeElement || !document.activeElement.closest('.ai-tools-menu')) {
                document.querySelectorAll('.ai-tools-menu.active').forEach(menu => {
                    menu.classList.remove('active');
                });
            }
        }, 100);
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ —É–≤–æ–¥–µ –º—ã—à–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –ø–∞–Ω–µ–ª–∏
    document.addEventListener('mouseleave', function(e) {
        if (e.target.closest('.ai-tools-menu')) {
            setTimeout(() => {
                const hoveredElement = document.elementFromPoint(e.clientX, e.clientY);
                if (!hoveredElement || !hoveredElement.closest('.ai-tools-menu')) {
                    document.querySelectorAll('.ai-tools-menu.active').forEach(menu => {
                        menu.classList.remove('active');
                    });
                }
            }, 200);
        }
    });

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏
    document.addEventListener('mousemove', function(e) {
        if (!e.target.closest('.ai-tools-menu') && !e.target.closest('.ai-tools-trigger')) {
            const activeMenus = document.querySelectorAll('.ai-tools-menu.active');
            if (activeMenus.length > 0) {
                let shouldClose = true;
                activeMenus.forEach(menu => {
                    const rect = menu.getBoundingClientRect();
                    const distance = Math.sqrt(
                        Math.pow(e.clientX - (rect.left + rect.width/2), 2) + 
                        Math.pow(e.clientY - (rect.top + rect.height/2), 2)
                    );
                    
                    const triggerId = menu.id.replace('-tools', '');
                    const trigger = document.querySelector(`[onclick*="${triggerId}"]`);
                    let triggerDistance = Infinity;
                    if (trigger) {
                        const triggerRect = trigger.getBoundingClientRect();
                        triggerDistance = Math.sqrt(
                            Math.pow(e.clientX - (triggerRect.left + triggerRect.width/2), 2) + 
                            Math.pow(e.clientY - (triggerRect.top + triggerRect.height/2), 2)
                        );
                    }
                    
                    if (distance < 120 || triggerDistance < 50) {
                        shouldClose = false;
                    }
                });
                
                if (shouldClose) {
                    activeMenus.forEach(menu => {
                        menu.classList.remove('active');
                    });
                }
            }
        }
    });

    // –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏
    async function aiOptimizeModel() {
        await callAITool('role-model/{{ role_model.id }}/optimize', { type: 'role_model', id: {{ role_model.id }} });
    }

    async function aiAnalyzeGaps() {
        await callAITool('role-model/{{ role_model.id }}/analyze-gaps', { type: 'role_model', id: {{ role_model.id }} });
    }

    async function aiSuggestProfiles() {
        addAIMessage('üí° –ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –¥–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –ø—Ä–µ–¥–ª–∞–≥–∞—é –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏: 1) "Senior Java Developer" (–æ–ø—ã—Ç 5+ –ª–µ—Ç), 2) "React Developer" (–æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –æ–±—â–µ–≥–æ Frontend), 3) "DevOps Engineer" (Docker, Kubernetes). –°–æ–∑–¥–∞—Ç—å —ç—Ç–∏ –ø—Ä–æ—Ñ–∏–ª–∏?');
    }

    async function aiCompareModels() {
        addAIMessage('‚öñÔ∏è –°—Ä–∞–≤–Ω–∏–≤–∞—é —Å –¥—Ä—É–≥–∏–º–∏ —Ä–æ–ª–µ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ –≤ —Å–∏—Å—Ç–µ–º–µ... –ù–∞—à–µ–ª –ø–æ—Ö–æ–∂–∏–µ –º–æ–¥–µ–ª–∏: "IT Support" –∏ "Data Engineer". –ú–æ–∂–µ–º –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞—Ç—å –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –ø—Ä–æ—Ñ–∏–ª–∏. –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏?');
    }

    async function aiValidateCriteria() {
        addAIMessage('‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π... –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã: 1) –í Java Backend —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (–ø–æ–ø–∞–¥–∞—é—Ç 45% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤), 2) –í Frontend –Ω–µ—Ç –∫—Ä–∏—Ç–µ—Ä–∏—è –ø–æ –æ–ø—ã—Ç—É —Å TypeScript. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏?');
    }

    async function aiGenerateReport() {
        addAIMessage('üìä –°–æ–∑–¥–∞—é –æ—Ç—á–µ—Ç –ø–æ —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏... –ì–æ—Ç–æ–≤ –æ—Ç—á–µ—Ç: {{ profiles|length }} –ø—Ä–æ—Ñ–∏–ª–µ–π, –ø–æ–∫—Ä—ã–≤–∞—é—Ç 0 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –¥–æ–±–∞–≤–∏—Ç—å Senior –ø—Ä–æ—Ñ–∏–ª–∏, —É—Ç–æ—á–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏. –û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç?');
    }

    // –ò–ò-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π
    async function aiOptimizeCriteria(profileId) {
        await callAITool(`profile/${profileId}/optimize-criteria`, { type: 'profile', id: profileId });
    }

    async function aiSuggestAccesses(profileId) {
        await callAITool(`profile/${profileId}/suggest-accesses`, { type: 'profile', id: profileId });
    }

    async function aiSplitProfile(profileId) {
        await callAITool(`profile/${profileId}/split`, { type: 'profile', id: profileId });
    }

    async function aiAutoComplete(profileId) {
        addAIMessage(`‚ú® –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω—è—é –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è ${profileId}... –î–æ–±–∞–≤–∏–ª: –∫—Ä–∏—Ç–µ—Ä–∏–π "—É—á–∞—Å—Ç–∏–µ –≤ code review", –¥–æ—Å—Ç—É–ø –∫ "—Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏". –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?`);
    }

    // –û–±—ã—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    function editProfile(profileId) {
        // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
        alert(`–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å ${profileId} - TODO`);
    }

    function duplicateProfile(profileId) {
        // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
        alert(`–î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å ${profileId} - TODO`);
    }

    function deleteProfile(profileId) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å?')) {
            // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
            alert(`–ü—Ä–æ—Ñ–∏–ª—å ${profileId} —É–¥–∞–ª–µ–Ω - TODO`);
        }
    }

    function addNewProfile() {
        // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
        alert('–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å - TODO');
    }

    async function saveModel() {
        try {
            const name = document.getElementById('roleModelName').value;
            const description = document.getElementById('roleModelDescription').value;
            
            // TODO: –†–µ–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            const response = await fetch(`/api/v1/role-models/{{ role_model.id }}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    name: name,
                    description: description
                })
            });
            
            if (response.ok) {
                addAIMessage('‚úÖ –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
                setTimeout(() => {
                    window.location.href = '/role-models/{{ role_model.id }}';
                }, 1000);
            } else {
                addAIMessage('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            addAIMessage('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
        }
    }
</script>
{% endblock %}
